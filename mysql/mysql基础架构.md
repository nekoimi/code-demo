# mysql基础

如图所示:

![30202835.png](https://i.loli.net/2019/06/30/5d18aafa670a891279.png)

- 第一层: 处理连接、授权认证等

- 第二层: 包括查询解析、分析、优化、缓存、内置函数、存储过程、触发器和视图都在这一层实现

- 第三层: 存储引擎，提供底层API

NySQL会解析查询语句，创建解析树，然后进行优化(重写查询、读取顺序、索引等)

### 并发控制

> 在处理并发读或写的时候，通常的锁体系包含两种: 共享锁(shared lock) 和 排他锁(exclusive lock)
> 也叫读锁(read lock)和写锁(write lock)


- 锁策略

> 在锁的开销和数据的安全性之间寻求平衡


#### 表锁(table lock)

> 表锁是MySQL中最基本的锁策略，是开销最小的策略

#### 行级索

> 行级锁可以最大程度的支持并发处理，开销也最大。行级锁由存储引擎实现


### 事务

> 一个独立的工作单元，一组原子性的SQL查询

```sql
START TRANSACTION   -- start

COMMIT              -- commit

ROLLBACK            -- 出错回滚
```

#### 标准特征 (ACID)

- 原子性(atomicity)

> 要么全部成功，要么全部回滚

- 一致性(consistency)

> 数据库状态的一致性

- 隔离性(isolation)

> 事务与事务之间的不可见性

- 持久性(durability)

> 只要事务成功提交，所做更改都将保存到数据库，不会消失
